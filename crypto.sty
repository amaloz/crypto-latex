%%
%% umdcrypto --- style file for crypto papers
%%
%% Author: Alex J Malozemoff < amaloz @ cs . umd . edu >
%%

\def\filename{crypto/crypto}
\def\fileversion{v0.1}
\def\filedate{2014/02/24}

\NeedsTeXFormat{LaTeX2e}
\AtEndOfPackage{\ProvidesPackage{\filename}
  [\filedate\space\fileversion\space(Alex J Malozemoff)]}
\typeout{Package `\filename', \fileversion, <\filedate>}

\RequirePackage{kvoptions}

\SetupKeyvalOptions{
  family=crypto,
  prefix=crypto@
}

%
% OPTION: color
%
\newif\if@color\@colorfalse%
\DeclareVoidOption{color}{%
  \@colortrue%
}

%
% OPTION: reflinks
%
\newif\if@reflinks\@reflinksfalse%
\DeclareVoidOption{reflinks}{%
  \@reflinkstrue%
}

%
% OPTION: submission
%
\newif\ifsubmission%
\submissionfalse%
\DeclareVoidOption{submission}{%
  \submissiontrue%
}

% \ProcessOptions%

%
% OPTION: security parameter
%
\DeclareStringOption[k]{secparam}
\define@key{crypto}{secparam}
{\newcommand{\secparam}{\ensuremath{#1}\xspace}}

\ProcessKeyvalOptions{crypto}

\RequirePackage{amsfonts,amsmath,amssymb,amsthm}
\RequirePackage{url}
\RequirePackage{xspace}

\if@reflinks
  \RequirePackage[colorlinks=true,citecolor=cyan,linkcolor=blue]{hyperref}
\fi

\ifsubmission%
  \newcommand{\authnote}[2]{}
  \newcommand{\TODO}[1]{}
  \newcommand{\FINISH}{}
  \newcommand{\verified}{}
\else%
  \if@color%
    \RequirePackage{color}
    \newcommand{\authnote}[3]{\textcolor{#3}{\footnotesize\textbf{[#1: #2]}}}
    \newcommand{\TODO}[1]{\noindent\textcolor{red}{\footnotesize\textbf{TODO\@:
          {#1}}}}
    \newcommand{\FINISH}{\textcolor{red}{\footnotesize\textbf{FINISH}}}
  \else
    \newcommand{\authnote}[3]{{\footnotesize\textbf{[#1: #2]}}}
    \newcommand{\TODO}[1]{\noindent{\footnotesize\textbf{TODO\@: {#1}}}}
    \newcommand{\FINISH}{\footnotesize\textbf{FINISH}}
  \fi

  \newcommand{\verified}[1]{\begin{center}\fbox{{\bf\small Verified: #1}}\end{center}}
\fi

\renewcommand\AA{\ensuremath{\mathbb A}\xspace}
\newcommand\BB{\ensuremath{\mathbb B}\xspace}
\newcommand\CC{\ensuremath{\mathbb C}\xspace}
\newcommand\DD{\ensuremath{\mathbb D}\xspace}
\newcommand\EE{\ensuremath{\mathbb E}\xspace}
\newcommand\FF{\ensuremath{\mathbb F}\xspace}
\newcommand\GG{\ensuremath{\mathbb G}\xspace}
\newcommand\HH{\ensuremath{\mathbb H}\xspace}
\newcommand\II{\ensuremath{\mathbb I}\xspace}
\newcommand\NN{\ensuremath{\mathbb N}\xspace}
\newcommand\PP{\ensuremath{\mathbb P}\xspace}
\newcommand\QQ{\ensuremath{\mathbb Q}\xspace}
\newcommand\RR{\ensuremath{\mathbb R}\xspace}
\newcommand\VV{\ensuremath{\mathbb V}\xspace}
\newcommand\XX{\ensuremath{\mathbb X}\xspace}
\newcommand\ZZ{\ensuremath{\mathbb Z}\xspace}

\newcommand\AAA{\ensuremath{\mathcal A}\xspace}
\newcommand\BBB{\ensuremath{\mathcal B}\xspace}
\newcommand\CCC{\ensuremath{\mathcal C}\xspace}
\newcommand\DDD{\ensuremath{\mathcal D}\xspace}
\newcommand\EEE{\ensuremath{\mathcal E}\xspace}
\newcommand\FFF{\ensuremath{\mathcal F}\xspace}
\newcommand\GGG{\ensuremath{\mathcal G}\xspace}
\newcommand\HHH{\ensuremath{\mathcal H}\xspace}
\newcommand\III{\ensuremath{\mathcal I}\xspace}
\newcommand\JJJ{\ensuremath{\mathcal J}\xspace}
\newcommand\KKK{\ensuremath{\mathcal K}\xspace}
\newcommand\LLL{\ensuremath{\mathcal L}\xspace}
\newcommand\MMM{\ensuremath{\mathcal M}\xspace}
\newcommand\NNN{\ensuremath{\mathcal N}\xspace}
\newcommand\OOO{\ensuremath{\mathcal O}\xspace}
\newcommand\PPP{\ensuremath{\mathcal P}\xspace}
\newcommand\QQQ{\ensuremath{\mathcal Q}\xspace}
\newcommand\RRR{\ensuremath{\mathcal R}\xspace}
\newcommand\SSS{\ensuremath{\mathcal S}\xspace}
\newcommand\TTT{\ensuremath{\mathcal T}\xspace}
\newcommand\UUU{\ensuremath{\mathcal U}\xspace}
\newcommand\VVV{\ensuremath{\mathcal V}\xspace}
\newcommand\WWW{\ensuremath{\mathcal W}\xspace}
\newcommand\XXX{\ensuremath{\mathcal X}\xspace}
\newcommand\YYY{\ensuremath{\mathcal Y}\xspace}
\newcommand\ZZZ{\ensuremath{\mathcal Z}\xspace}

%
% Generic macros
%

\newcommand{\bool}{{\ensuremath{\{0,1\}}}}
\newcommand{\oneton}{\ensuremath{\{1,\ldots,n\}}}
\newcommand{\oneto}[1]{\ensuremath{\{1,\ldots,#1\}}}
\newcommand{\zeroton}{\ensuremath{\{0,\ldots,n\}}}
\newcommand{\zeroto}[1]{\ensuremath{\{0,\ldots,#1\}}}

\renewcommand{\to}{\ensuremath{\rightarrow}}
\newcommand{\from}{\ensuremath{\leftarrow}}

\newcommand{\intersection}{\ensuremath{\cap}}
\newcommand{\union}{\ensuremath{\cup}}

\newcommand{\xor}{\ensuremath{\oplus}}
\newcommand{\Xor}{\ensuremath{\bigoplus}}

\newcommand{\bra}{\ensuremath{\langle}}
\newcommand{\ket}{\ensuremath{\rangle}}

\newcommand{\eps}{\ensuremath{\epsilon}}

\newcommand{\randin}{\ensuremath{\in_R}}
\newcommand{\eqdef}{\stackrel{\textrm{def}}{=}}

\newcommand{\angles}[1]{\ensuremath{\langle{#1}\rangle}}
\newcommand{\ceil}[1]{\ensuremath{\lceil{#1}\rceil}}
\newcommand{\floor}[1]{\ensuremath{\lfloor{#1}\rfloor}}
\newcommand{\pair}[2]{\ensuremath{\langle{#1,#2}\rangle}}

\newcommand{\abs}[1]{\ensuremath{\lvert{#1}\rvert}}
\newcommand{\Abs}[1]{\ensuremath{\left\lvert{#1}\right\rvert}}
\newcommand{\brac}[1]{\ensuremath{[#1]}}
\newcommand{\Brac}[1]{\ensuremath{\left[#1\right]}}
\newcommand{\norm}[1]{\ensuremath{\lVert{#1}\rVert}}
\newcommand{\Norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\paren}[1]{\ensuremath{(#1)}}
\newcommand{\Paren}[1]{\ensuremath{\left(#1\right)}}
\newcommand{\set}[1]{\ensuremath{\{#1\}}}
\newcommand{\Set}[1]{\ensuremath{\left\{#1\right\}}}
\newcommand{\inv}{^{-1}}

\newcommand{\Prob}[1]{{\Pr\left[{#1}\right]}}

\newcommand{\poly}{\ensuremath{\text{poly}}}

\newcommand{\bigo}[1]{\ensuremath{\OOO\Paren{#1}}}
\newcommand{\ppt}{\ensuremath{\textsc{ppt}}\xspace}

\newcommand{\Party}[1][\relax]{\ensuremath{P_{#1}}\xspace}
\newcommand{\Partym}[1][\relax]{\ensuremath{P_{#1}^*}\xspace}
\newcommand{\PA}{\Party[1]}
\newcommand{\PB}{\Party[2]}
\newcommand{\PC}{\Party[3]}
\newcommand{\PAm}{\Partym[1]}
\newcommand{\PBm}{\Partym[2]}
\newcommand{\PCm}{\Partym[3]}

\newcommand{\Sim}[1][\relax]{\ensuremath{\SSS_{#1}}\xspace}
\newcommand{\Adv}[1][\relax]{\ensuremath{\mathcal{A}_{#1}}\xspace}
\newcommand{\Oracle}{\ensuremath{\mathcal{O}}\xspace}

\newcommand{\Hybrid}[1][\relax]{\ensuremath{\mathbf{Hybrid_{#1}}}\xspace}
\newcommand{\Real}{\ensuremath{\mathbf{Real}}\xspace}
\newcommand{\Ideal}{\ensuremath{\mathbf{Ideal}}\xspace}

\newcommand{\ind}{\ensuremath{\approx}}
\newcommand{\cind}{\stackrel{\textrm{c}}{\ind}}
\newcommand{\dind}{\stackrel{\textrm{d}}{\ind}}

\newcommand{\Zp}{\ensuremath{\ZZ_p}}
\newcommand{\Zq}{\ensuremath{\ZZ_q}}

%
% Reference macros
%

\if@reflinks%
\newcommand{\sref}[2]{\hyperref[#2]{#1~\ref*{#2}}}
\else
\newcommand{\sref}[2]{#1~\ref{#2}}
\fi

\newcommand{\refalg}[1]{\sref{Algorithm}{#1}}
\newcommand{\refapx}[1]{\sref{Appendix}{#1}}
\newcommand{\refconst}[1]{\sref{Construction}{#1}}
\newcommand{\refdef}[1]{\sref{Definition}{#1}}
\newcommand{\refeqn}[1]{\ref{#1}}
\newcommand{\reffact}[1]{\sref{Fact}{#1}}
\newcommand{\reffig}[1]{\sref{Figure}{#1}}
\newcommand{\reflemma}[1]{\sref{Lemma}{#1}}
\newcommand{\refcor}[1]{\sref{Corollary}{#1}}
\newcommand{\refprop}[1]{\sref{Property}{#1}}
\newcommand{\refprot}[1]{\sref{Protocol}{#1}}
\newcommand{\refsec}[1]{\sref{Section}{#1}}
\newcommand{\refstep}[1]{\sref{Step}{#1}}
\newcommand{\reftab}[1]{\sref{Table}{#1}}
\newcommand{\refthm}[1]{\sref{Theorem}{#1}}

%% \newcommand{\refsteps}[2][\relax]{%
%%   \def\tempa{}%
%%   \@for\reserved:=#2\do{%
%%     \edef\tempa{\tempa\ifx\tempa\empty\else~#1 \fi\ref{\reserved}}%
%%   }%
%%   Steps~\tempa%
%% }

\newtheorem{claim}{Claim}
\@ifclassloaded{beamer}{}
{\newtheorem{lemma}{Lemma}}
\newtheorem*{lemma*}{Lemma}
\@ifclassloaded{beamer}{}
{\newtheorem{theorem}{Theorem}}
\newtheorem*{theorem*}{Theorem}
\theoremstyle{definition}
\@ifclassloaded{beamer}{}
{\newtheorem{definition}{Definition}}
\newtheorem{protocol}{Protocol}

\newcommand{\Gb}{{\ensuremath{\mathsf{Garble}}}\xspace}
\newcommand{\En}{{\ensuremath{\mathsf{Encrypt}}}\xspace}
\newcommand{\De}{{\ensuremath{\mathsf{Decrypt}}}\xspace}
\newcommand{\ev}{{\ensuremath{\mathsf{eval}}}\xspace}
\newcommand{\Ev}{{\ensuremath{\mathsf{Eval}}}\xspace}

\newcommand{\PrvInd}{{\ensuremath{\mathrm{PrvInd}}}\xspace}
\newcommand{\PrvSim}{{\ensuremath{\mathrm{PrvSim}}}\xspace}

\newcommand{\KeyGen}{{\ensuremath{\mathsf{KeyGen}}}\xspace}
\newcommand{\Gen}{{\ensuremath{\mathsf{Gen}}}\xspace}
\newcommand{\Enc}{{\ensuremath{\mathsf{Enc}}}\xspace}
\newcommand{\Dec}{{\ensuremath{\mathsf{Dec}}}\xspace}
\newcommand{\pk}{{\ensuremath{pk}}\xspace}
\newcommand{\sk}{{\ensuremath{sk}}\xspace}

\newcommand{\com}{\ensuremath{\mathsf{com}}\xspace}
\newcommand{\proc}{{\ensuremath{\mathbf{procedure}}}\xspace}

\newcommand{\len}{\ensuremath{\ell}\xspace}

% \newcommand{\secparam}{\ensuremath{k}\xspace}
\newcommand{\secpar}{\secparam}
\newcommand{\ssecparam}{\ensuremath{s}\xspace}
\newcommand{\ssecpar}{\ssecparam}

\newcommand{\mask}{\ensuremath{\lambda}\xspace}

\newcommand{\boolsec}{\ensuremath{\bool^\secparam}\xspace}
\newcommand{\onesec}{\ensuremath{1^\secparam}\xspace}

\newcommand{\iO}{{\ensuremath{i\mathcal{O}}}\xspace}

\newcommand{\indcpa}{\textsf{IND-CPA}\xspace}

%
% Environments
%

\newlength{\saveparindent}
\setlength{\saveparindent}{\parindent}
\newlength{\saveparskip}
\setlength{\saveparskip}{\parskip}

\newcounter{ctr}
\newcounter{savectr}
\newcounter{ectr}

\newenvironment{tiret}{%
  \begin{list}
    {\hspace{1pt}\rule[0.5ex]{6pt}{1pt}\hfill}
    {\labelwidth=15pt%
      \labelsep=3pt%
      \leftmargin=18pt%
      \topsep=1pt%
      \setlength{\listparindent}{\saveparindent}%
      \setlength{\parsep}{\saveparskip}%
      \setlength{\itemsep}{1pt}}
}{%
  \end{list}
}

\newenvironment{venum}{%
  \begin{list}
    {{\rm\arabic{ctr}.}\hfill}
    {\usecounter{ctr}%
      \labelwidth=17pt%
      \labelsep=6pt%
      \leftmargin=23pt%
      \topsep=.5pt%
      %% \setlength{\listparindent}{\saveparindent}%
      \setlength{\parsep}{\saveparskip}%
      \setlength{\itemsep}{1pt}}
}{%
  \end{list}
}

\newenvironment{cenumerate}{
  \begin{enumerate}
    \setlength{\itemsep}{1pt}
    \setlength{\parskip}{0pt}
    \setlength{\parsep}{0pt}
}{
  \end{enumerate}
}

\newenvironment{nfbox}[1]{
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
          #1
}{%
      \end{minipage}
    \end{framed}
  \end{center}
}

\newenvironment{nfprot}[2]{
  \footnotesize
  \begin{framed}
    \vspace{-3ex}
    {\begin{center}{\bf Protocol} #1 \end{center}}
    #2
  }{
    \smallskip
  \end{framed}
}

\newenvironment{nfprotfig}[2]{
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
        {\begin{center}{\bf Protocol} #1 \end{center}}
        #2
}{
        \smallskip
      \end{minipage}
    \end{framed}
  \end{center}
}


\newenvironment{nffunc}[2]{
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
        \underline{{\bf Functionality} #1}
        \medskip
        #2
}{%
      \end{minipage}
    \end{framed}
  \end{center}
}

\newcommand{\cancel}[1]{}

% functionalities
\newcommand{\Func}[1][\relax]{\ensuremath{\mathcal{F}_\mathbf{#1}}\xspace}
% protocols
\newcommand{\Prot}[1][\relax]{\ensuremath{\Pi_\mathbf{#1}}\xspace}

\newcommand{\randfrom}{\ensuremath{\stackrel{\$}{\from}}}

\newcommand{\nins}{\ensuremath{\mathsf{n}}}
\newcommand{\ngates}{\ensuremath{\mathsf{q}}}
\newcommand{\nouts}{\ensuremath{\mathsf{m}}}
\newcommand{\lfn}{\ensuremath{L}}
\newcommand{\rfn}{\ensuremath{R}}
\newcommand{\gfn}{\ensuremath{G}}
\newcommand{\pfn}{\ensuremath{P}}

\newcommand{\C}{\ensuremath{C}\xspace}
\newcommand{\sh}[1]{\Brac{#1}}
\newcommand{\bsh}[1]{\angles{#1}}
\newcommand{\ash}[1]{[\![#1]\!]}
\newcommand{\s}[1]{\ensuremath{\hat{#1}}\xspace}
\newcommand{\Aenc}{\ensuremath{\mathcal{A}^{\textbf{Enc}}}\xspace}
\newcommand{\party}[1]{\ensuremath{^{(#1)}}}
\newcommand{\step}[2]{{\bf [#1: #2]}}
\newcommand{\noti}{{\bar{\imath}}}
\newcommand{\header}[1]{\noindent{\bf #1:}}
%% \newcommand{\token}[1]{\begin{center}\fbox{{\bf\textcolor{red}{Token:
%%           #1}}}\end{center}}
\newcommand{\tweak}{\ensuremath{T}}

\newcommand{\bbsh}[1]{\bsh{#1}}
\newcommand{\mtag}[1]{\ensuremath{t_{#1}}\xspace}
\newcommand{\mkey}[1]{\ensuremath{k_{#1}}\xspace}
\newcommand{\mver}{\ensuremath{\mathsf{Verify}}\xspace}

\newcommand{\Fail}[1]{\ensuremath{\mathsf{Fail}_{#1}}}

%
% bibtex stuff
%

\newcommand{\FullVersion}[1]{Full version available at \url{#1}}

\endinput
