%%
%% crypto --- style file for crypto papers
%%
%% Author: Alex J. Malozemoff < amaloz@cs.umd.edu >
%%

\def\filename{crypto/crypto}
\def\fileversion{v0.1}
\def\filedate{2014/02/24}
\def\fileauthor{Alex J Malozemoff}

\NeedsTeXFormat{LaTeX2e}
\AtEndOfPackage{\ProvidesPackage{\filename}
  [\filedate\space\fileversion\space(\fileauthor)]}
\typeout{Package `\filename', \fileversion, <\filedate>}

\RequirePackage{kvoptions}
\SetupKeyvalOptions{%
  family=crypto,%
  prefix=crypto@%
}

\DeclareBoolOption[false]{color}
\DeclareBoolOption[false]{draft}
\DeclareBoolOption[false]{reflinks}
\DeclareBoolOption[false]{lncs}
\DeclareBoolOption[false]{submission}
\DeclareStringOption[k]{secparam}
\ProcessKeyvalOptions{crypto}
\newcommand{\secparam}{{\ensuremath{\crypto@secparam}}\xspace}

\ifcrypto@color%
  \RequirePackage{color}
\fi

\ifcrypto@reflinks%
  \ifcrypto@color%
    \RequirePackage[colorlinks=true]{hyperref}
  \else%
    \RequirePackage{hyperref}
  \fi
\fi

\RequirePackage{amsfonts,amsmath,amssymb}
\RequirePackage{framed}
\RequirePackage{url}
\RequirePackage{xspace}

\ifcrypto@draft%
  \usepackage{fancyhdr}
  \pagestyle{fancy}
  \fancyhead{}
  \chead{--- DRAFT ---}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
  \let\ps@plain\ps@fancy%
\fi%

\ifcrypto@submission%
  \newcommand{\authnote}[2]{}
  \newcommand{\TODO}[1]{}
  \newcommand{\FINISH}{}
  \newcommand{\verified}{}
\else%
  \ifcrypto@color%
    \newcommand{\authnote}[3]{\textcolor{#3}{\footnotesize\textbf{[#1: #2]}}}
    \newcommand{\TODO}[1]{\noindent\textcolor{red}{\footnotesize\textbf{TODO\@: {#1}}}}
    \newcommand{\FINISH}{\textcolor{red}{\footnotesize\textbf{FINISH}}}
  \else
    \newcommand{\authnote}[3]{{\footnotesize\textbf{[#1: #2]}}}
    \newcommand{\TODO}[1]{\noindent{\footnotesize\textbf{TODO\@: {#1}}}}
    \newcommand{\FINISH}{\footnotesize\textbf{FINISH}}
  \fi
  \newcommand{\verified}[1]{\begin{center}\fbox{{\bf\small Verified: #1}}\end{center}}
\fi

\newcommand\BB{\ensuremath{\mathbb B}\xspace}
\newcommand\CC{\ensuremath{\mathbb C}\xspace}
\newcommand\DD{\ensuremath{\mathbb D}\xspace}
\newcommand\EE{\ensuremath{\mathbb E}\xspace}
\newcommand\FF{\ensuremath{\mathbb F}\xspace}
\newcommand\GG{\ensuremath{\mathbb G}\xspace}
\newcommand\HH{\ensuremath{\mathbb H}\xspace}
\newcommand\II{\ensuremath{\mathbb I}\xspace}
\newcommand\NN{\ensuremath{\mathbb N}\xspace}
\newcommand\PP{\ensuremath{\mathbb P}\xspace}
\newcommand\QQ{\ensuremath{\mathbb Q}\xspace}
\newcommand\RR{\ensuremath{\mathbb R}\xspace}
\newcommand\VV{\ensuremath{\mathbb V}\xspace}
\newcommand\XX{\ensuremath{\mathbb X}\xspace}
\newcommand\ZZ{\ensuremath{\mathbb Z}\xspace}

\newcommand\AAA{\ensuremath{\mathcal A}\xspace}
\newcommand\BBB{\ensuremath{\mathcal B}\xspace}
\newcommand\CCC{\ensuremath{\mathcal C}\xspace}
\newcommand\DDD{\ensuremath{\mathcal D}\xspace}
\newcommand\EEE{\ensuremath{\mathcal E}\xspace}
\newcommand\FFF{\ensuremath{\mathcal F}\xspace}
\newcommand\GGG{\ensuremath{\mathcal G}\xspace}
\newcommand\HHH{\ensuremath{\mathcal H}\xspace}
\newcommand\III{\ensuremath{\mathcal I}\xspace}
\newcommand\JJJ{\ensuremath{\mathcal J}\xspace}
\newcommand\KKK{\ensuremath{\mathcal K}\xspace}
\newcommand\LLL{\ensuremath{\mathcal L}\xspace}
\newcommand\MMM{\ensuremath{\mathcal M}\xspace}
\newcommand\NNN{\ensuremath{\mathcal N}\xspace}
\newcommand\OOO{\ensuremath{\mathcal O}\xspace}
\newcommand\PPP{\ensuremath{\mathcal P}\xspace}
\newcommand\QQQ{\ensuremath{\mathcal Q}\xspace}
\newcommand\RRR{\ensuremath{\mathcal R}\xspace}
\newcommand\SSS{\ensuremath{\mathcal S}\xspace}
\newcommand\TTT{\ensuremath{\mathcal T}\xspace}
\newcommand\UUU{\ensuremath{\mathcal U}\xspace}
\newcommand\VVV{\ensuremath{\mathcal V}\xspace}
\newcommand\WWW{\ensuremath{\mathcal W}\xspace}
\newcommand\XXX{\ensuremath{\mathcal X}\xspace}
\newcommand\YYY{\ensuremath{\mathcal Y}\xspace}
\newcommand\ZZZ{\ensuremath{\mathcal Z}\xspace}

%
% Generic macros
%

\newcommand{\bool}[1][\relax]{{\ensuremath{{\{0,1\}}^{#1}}}\xspace}
\newcommand{\boolstar}{\bool[*]}
\newcommand{\one}[1][\relax]{{\ensuremath{1^{#1}}}\xspace}
\newcommand{\oneton}{\ensuremath{\{1,\ldots,n\}}}
\newcommand{\oneto}[1]{\ensuremath{\{1,\ldots,#1\}}}
\newcommand{\zeroton}{\ensuremath{\{0,\ldots,n\}}}
\newcommand{\zeroto}[1]{\ensuremath{\{0,\ldots,#1\}}}

\renewcommand{\to}{\ensuremath{\rightarrow}}
\newcommand{\from}{\ensuremath{\leftarrow}}
\newcommand{\randfrom}{\ensuremath{{\,\from\raisebox{0.5pt}{\!\!\tiny\$}\,}}}

\newcommand{\intersection}{\ensuremath{\cap}}
\newcommand{\union}{\ensuremath{\cup}}

\newcommand{\xor}{\ensuremath{\oplus}}
\newcommand{\Xor}{\ensuremath{\bigoplus}}

\newcommand{\bra}{\ensuremath{\langle}}
\newcommand{\ket}{\ensuremath{\rangle}}

\newcommand{\eps}{\ensuremath{\epsilon}}

\newcommand{\randin}{\ensuremath{\in_R}}
\newcommand{\eqdef}{\stackrel{\textrm{def}}{=}}
\newcommand{\inq}{\stackrel{\textrm{?}}{\in}}

\newcommand{\angles}[1]{\ensuremath{\langle{#1}\rangle}}
\newcommand{\ceil}[1]{\ensuremath{\lceil{#1}\rceil}}
\newcommand{\floor}[1]{\ensuremath{\lfloor{#1}\rfloor}}
\newcommand{\pair}[2]{\ensuremath{\langle{#1,#2}\rangle}}

\newcommand{\abs}[1]{\ensuremath{\lvert{#1}\rvert}}
\newcommand{\Abs}[1]{\ensuremath{\left\lvert{#1}\right\rvert}}
\newcommand{\brac}[1]{\ensuremath{[#1]}}
\newcommand{\Brac}[1]{\ensuremath{\left[#1\right]}}
\newcommand{\norm}[1]{\ensuremath{\lVert{#1}\rVert}}
\newcommand{\Norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\paren}[1]{\ensuremath{(#1)}}
\newcommand{\Paren}[1]{\ensuremath{\left(#1\right)}}
\newcommand{\set}[1]{\ensuremath{\{#1\}}}
\newcommand{\Set}[1]{\ensuremath{\left\{#1\right\}}}

\newcommand{\Prob}[1]{{\Pr\left[{#1}\right]}}
\newcommand{\Succ}{\ensuremath{\mathsf{Succ}}\xspace}

\newcommand{\bigo}[1]{\ensuremath{O\Paren{#1}}}
\newcommand{\bigotilde}[1]{\ensuremath{\widetilde{O}\Paren{#1}}}
\newcommand{\ppt}{\ensuremath{\textsc{ppt}}\xspace}
\newcommand{\PPT}{\ensuremath{\textsc{ppt}}\xspace}
\newcommand{\poly}{\ensuremath{\mathsf{poly}}}
\newcommand{\inv}{^{-1}}

\newcommand{\ind}{\ensuremath{\approx}}
\newcommand{\cind}{\stackrel{\textrm{c}}{\ind}}
\newcommand{\dind}{\stackrel{\textrm{d}}{\ind}}

% http://www.matthewflickinger.com/blog/archives/2005/02/20/latex_mod_spacing.asp
\newcommand{\imod}[1]{\allowbreak\mkern10mu({\operator@font mod}\,\,#1)}

% Complexity classes
\newcommand{\NCone}{{\ensuremath{\mathbf{NC}$^1$}}\xspace}
\newcommand{\Ptime}{{\ensuremath{\mathbf{P}}}\xspace}
\newcommand{\NP}{{\ensuremath{\mathbf{NP}}}\xspace}

% Party macros
\newcommand{\Party}[1][\relax]{{\ensuremath{P_{#1}}}\xspace}
\newcommand{\Partym}[1][\relax]{{\ensuremath{P_{#1}^*}}\xspace}
\newcommand{\PA}{{\Party[1]}\xspace}
\newcommand{\PB}{{\Party[2]}\xspace}
\newcommand{\PC}{{\Party[3]}\xspace}
\newcommand{\PAm}{{\Partym[1]}\xspace}
\newcommand{\PBm}{{\Partym[2]}\xspace}
\newcommand{\PCm}{{\Partym[3]}\xspace}

\newcommand{\Sim}[1][\relax]{{\ensuremath{\SSS_{#1}}}\xspace}
\newcommand{\Adv}[1][\relax]{{\ensuremath{\mathcal{A}_{#1}}}\xspace}
\newcommand{\Aenc}{{\ensuremath{\mathcal{A}^{\textbf{Enc}}}}\xspace}
\newcommand{\Oracle}{{\ensuremath{\mathcal{O}}}\xspace}

\newcommand{\Hybrid}[1][\relax]{\ensuremath{\mathbf{Hybrid_{#1}}}\xspace}
\newcommand{\Real}{\ensuremath{\mathbf{Real}}\xspace}
\newcommand{\Ideal}{\ensuremath{\mathbf{Ideal}}\xspace}

% Groups
\newcommand{\Zp}{{\ensuremath{\ZZ_p}}\xspace}
\newcommand{\Zq}{{\ensuremath{\ZZ_q}}\xspace}

% Bilinear groups
\newcommand{\egg}{{\ensuremath{{e(g,g)}}}\xspace}

%
% Reference macros
%
\ifcrypto@reflinks%
  \newcommand{\sref}[2]{\hyperref[#2]{#1~\ref*{#2}}}
\else
  \newcommand{\sref}[2]{#1~\ref{#2}}
\fi
\newcommand{\refalg}[1]{\sref{Algorithm}{#1}}
\newcommand{\refapx}[1]{\sref{Appendix}{#1}}
\newcommand{\refconst}[1]{\sref{Construction}{#1}}
\newcommand{\refdef}[1]{\sref{Definition}{#1}}
\newcommand{\refeqn}[1]{\sref{Equation}{#1}}
\newcommand{\reffact}[1]{\sref{Fact}{#1}}
\newcommand{\reffig}[1]{\sref{Figure}{#1}}
\newcommand{\reflemma}[1]{\sref{Lemma}{#1}}
\newcommand{\refcor}[1]{\sref{Corollary}{#1}}
\newcommand{\refprop}[1]{\sref{Property}{#1}}
\newcommand{\refprot}[1]{\sref{Protocol}{#1}}
\newcommand{\refsec}[1]{\sref{Section}{#1}}
\newcommand{\refstep}[1]{\sref{Step}{#1}}
\newcommand{\reftab}[1]{\sref{Table}{#1}}
\newcommand{\refthm}[1]{\sref{Theorem}{#1}}
\ifcrypto@lncs%
\renewcommand{\refeqn}[1]{\ref{(#1)}}
\renewcommand{\reffig}[1]{\sref{Fig.}{#1}}
\renewcommand{\refsec}[1]{\sref{Sect.}{#1}}
\fi

% Bellare, Hoang, Rogaway notation
\newcommand{\Gb}{{\ensuremath{\mathsf{Garble}}}\xspace}
\newcommand{\En}{{\ensuremath{\mathsf{Encrypt}}}\xspace}
\newcommand{\De}{{\ensuremath{\mathsf{Decrypt}}}\xspace}
\newcommand{\ev}{{\ensuremath{\mathsf{eval}}}\xspace}
\newcommand{\Ev}{{\ensuremath{\mathsf{Eval}}}\xspace}
\newcommand{\nins}{\ensuremath{\mathsf{n}}\xspace}
\newcommand{\ngates}{\ensuremath{\mathsf{q}}\xspace}
\newcommand{\nouts}{\ensuremath{\mathsf{m}}\xspace}
\newcommand{\lfn}{\ensuremath{L}\xspace}
\newcommand{\rfn}{\ensuremath{R}\xspace}
\newcommand{\gfn}{\ensuremath{G}\xspace}
\newcommand{\pfn}{\ensuremath{P}\xspace}

% Generate
\newcommand{\gen}{{\ensuremath{\mathsf{gen}}}\xspace}
\newcommand{\Gen}{{\ensuremath{\mathsf{Gen}}}\xspace}
\newcommand{\KeyGen}{{\ensuremath{\mathsf{KeyGen}}}\xspace}

% Encrypt
\newcommand{\enc}{{\ensuremath{\mathsf{enc}}}\xspace}
\newcommand{\Enc}{{\ensuremath{\mathsf{Enc}}}\xspace}
\newcommand{\Encrypt}{{\ensuremath{\mathsf{Encrypt}}}\xspace}

% Decrypt
\newcommand{\dec}{{\ensuremath{\mathsf{dec}}}\xspace}
\newcommand{\Dec}{{\ensuremath{\mathsf{Dec}}}\xspace}
\newcommand{\Decrypt}{{\ensuremath{\mathsf{Decrypt}}}\xspace}

% Signatures
\newcommand{\Sig}{{\ensuremath{\mathsf{Sig}}}\xspace}

% Zero-knowledge
\newcommand{\Prv}{{\ensuremath{\mathsf{Prv}}}\xspace}
\newcommand{\Ver}{{\ensuremath{\mathsf{Ver}}}\xspace}

% Public key
\newcommand{\pk}{{\ensuremath{\mathsf{pk}}}\xspace}
\newcommand{\PK}{{\ensuremath{\textsc{pk}}}\xspace}

% Private key
\newcommand{\sk}{{\ensuremath{\mathsf{sk}}}\xspace}
\newcommand{\SK}{{\ensuremath{\textsc{sk}}}\xspace}

% CRS stuff
\newcommand{\crs}{{\ensuremath{\mathsf{crs}}}\xspace}
\newcommand{\CRSGen}{{\ensuremath{\mathsf{CRSGen}}}\xspace}

% Other
\newcommand{\PrivK}{{\ensuremath{\mathsf{PrivK}}}\xspace}
\newcommand{\PubK}{{\ensuremath{\mathsf{PubK}}}\xspace}
\newcommand{\com}{\ensuremath{\mathsf{com}}\xspace}
\newcommand{\proc}{{\ensuremath{\mathbf{procedure}}}\xspace}
\newcommand{\negl}{\ensuremath{\mathsf{negl}}\xspace}
\newcommand{\aux}{{\ensuremath{\mathsf{aux}}}\xspace}
\newcommand{\Eval}{{\ensuremath{\mathsf{Eval}}}\xspace}
\newcommand{\Samp}{{\ensuremath{\mathsf{Samp}}}\xspace}
\newcommand{\PrvInd}{{\ensuremath{\mathrm{PrvInd}}}\xspace}
\newcommand{\PrvSim}{{\ensuremath{\mathrm{PrvSim}}}\xspace}
\newcommand{\Setup}{\ensuremath{\mathsf{Setup}}\xspace}

% Security parameters
\newcommand{\secpar}{\secparam}
\newcommand{\csp}{\secpar}
\newcommand{\ssecparam}{\ensuremath{\rho}\xspace}
\newcommand{\ssecpar}{\ssecparam}
\newcommand{\ssp}{\ssecpar}

\newcommand{\boolsec}{\ensuremath{\bool^\secparam}\xspace}
\newcommand{\onesec}{\ensuremath{1^\secparam}\xspace}

% Obfuscation
\newcommand{\Obf}{{\ensuremath{\text{\textsf{Obf}}}}\xspace}
\newcommand{\iO}{{\ensuremath{i\OOO}}\xspace}
\newcommand{\diO}{{\ensuremath{\mathsf{diO}}}\xspace}

% Security definitions
\newcommand{\indcpa}{\textsf{IND-CPA}\xspace}

% Oblivious Transfer
\newcommand{\genot}[4]{{\ensuremath{\binom{#2}{#1}\text{-OT}_{#3}^{#4}}}\xspace}
\newcommand{\ot}[2]{\genot{1}{2}{#1}{#2}}

% Functionalities/Protocols
\newcommand{\Func}[1][\relax]{\ensuremath{\mathcal{F}_\mathbf{#1}}\xspace}
\newcommand{\Prot}[1][\relax]{\ensuremath{\Pi_\mathbf{#1}}\xspace}

\newcommand{\Fpki}{\Func[\mathsf{PKI}]\xspace}

% Garbled circuits
\newcommand{\GC}{\ensuremath{\text{GC}}\xspace}
\newcommand{\C}{\ensuremath{C}\xspace}

% Secret sharing
\newcommand{\sh}[1]{\Brac{#1}}
\newcommand{\bsh}[1]{\angles{#1}}
\newcommand{\ash}[1]{[\![#1]\!]}
\newcommand{\s}[1]{\ensuremath{\hat{#1}}\xspace}

% Other
\newcommand{\accept}{{\ensuremath{\mathsf{accept}}}\xspace}
\newcommand{\reject}{{\ensuremath{\mathsf{reject}}}\xspace}
\newcommand{\mask}{\ensuremath{\lambda}\xspace}
\newcommand{\onehalf}{\ensuremath{\frac{1}{2}}\xspace}
\newcommand{\len}{\ensuremath{\ell}\xspace}

\newcommand{\vct}[1]{\ensuremath{\mathbf{#1}}\xspace}

\newcommand{\party}[1]{\ensuremath{^{(#1)}}}
\newcommand{\step}[2]{{\bfseries [#1: #2]}}
\newcommand{\noti}{{\bar{\imath}}}

\newcommand{\header}[1]{\noindent{\bfseries #1:}}
\newcommand{\tweak}{\ensuremath{T}}

\newcommand{\Fail}[1]{\ensuremath{\mathsf{Fail}_{#1}}}

%
% Environments
%

\newlength{\saveparindent}
\setlength{\saveparindent}{\parindent}
\newlength{\saveparskip}
\setlength{\saveparskip}{\parskip}

\newcounter{ctr}
\newcounter{savectr}
\newcounter{ectr}

\newenvironment{tiret}{%
  \begin{list}
    {\hspace{1pt}\rule[0.5ex]{6pt}{1pt}\hfill}
    {\labelwidth=15pt%
      \labelsep=3pt%
      \leftmargin=18pt%
      \topsep=1pt%
      \setlength{\listparindent}{\saveparindent}%
      \setlength{\parsep}{\saveparskip}%
      \setlength{\itemsep}{1pt}}
}{%
  \end{list}
}

\newenvironment{venum}{%
  \begin{list}
    {{\rmfamily \arabic{ctr}.}\hfill}
    {\usecounter{ctr}%
      \labelwidth=17pt%
      \labelsep=6pt%
      \leftmargin=23pt%
      \topsep=.5pt%
      %% \setlength{\listparindent}{\saveparindent}%
      \setlength{\parsep}{\saveparskip}%
      \setlength{\itemsep}{1pt}}
}{%
  \end{list}
}

\newenvironment{cenumerate}{
  \begin{enumerate}
    \setlength{\itemsep}{1pt}
    \setlength{\parskip}{0pt}
    \setlength{\parsep}{0pt}
}{
  \end{enumerate}
}

\newenvironment{citemize}{
  \begin{itemize}
    \setlength{\itemsep}{1pt}
    \setlength{\parskip}{0pt}
    \setlength{\parsep}{0pt}
}{
  \end{itemize}
}

\newenvironment{nfbox}{%
  \centering\footnotesize
  \begin{framed}
    \begin{minipage}{\linewidth}
}{%
    \end{minipage}
  \end{framed}
}

\newenvironment{nfprot}[1]{%
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
        {\begin{center}\underline{\textbf{Protocol} #1}\end{center}}
}{%
      \end{minipage}
    \end{framed}
  \end{center}
}

\newenvironment{nffunc}[1]{%
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
        {\begin{center}\underline{\textbf{Functionality} #1}\end{center}}
}{%
      \end{minipage}
    \end{framed}
  \end{center}
}

%
% bibtex stuff
%

\newcommand{\FullVersion}[1]{Full version available at \url{#1}}
\newcommand{\ProceedingsVersion}[1]{Proceedings version available at \url{#1}}

\endinput
