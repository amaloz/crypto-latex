%%
%% umdcrypto --- style file for crypto papers
%%
%% Author: Alex J Malozemoff < amaloz @ cs . umd . edu >
%%

\def\filename{umdcrypto}
\def\fileversion{v0.1}
\def\filedate{2013/09/27}

\NeedsTeXFormat{LaTeX2e}
\AtEndOfPackage{\ProvidesPackage{\filename}
  [\filedate\space\fileversion\space(Alex J Malozemoff)]}
\typeout{Package `\filename', \fileversion, <\filedate>}

%
% OPTION: color
%
\newif\ifcolor%
\colorfalse%
\DeclareOption{color}{%
  \colortrue%
}

%
% OPTION: reflinks
%
\newif\ifreflinks%
\reflinksfalse%
\DeclareOption{reflinks}{%
  \reflinkstrue%
}

%
% OPTION: submission
%
\newif\ifsubmission%
\submissionfalse%
\DeclareOption{submission}{%
  \submissiontrue%
}

\ProcessOptions%

\RequirePackage{amsfonts,amsmath,amssymb,amsthm}
\RequirePackage{url}
\RequirePackage{xspace}

\ifreflinks
  \RequirePackage[colorlinks=true,citecolor=cyan,linkcolor=blue]{hyperref}
\fi

\ifsubmission%
  \newcommand{\authnote}[2]{}
  \newcommand{\TODO}[1]{}
  \newcommand{\verified}{}
\else%
  \ifcolor%
    \RequirePackage{color}
    \newcommand{\authnote}[3]{\textcolor{#3}{\footnotesize\textbf{[#1: #2]}}}
    \newcommand{\TODO}[1]{\noindent\textcolor{red}{\footnotesize\textbf{TODO\@: {#1}}}}
  \else
    \newcommand{\authnote}[3]{{\footnotesize\textbf{[#1: #2]}}}
    \newcommand{\TODO}[1]{\noindent{\footnotesize\textbf{TODO\@: {#1}}}}
  \fi

  \newcommand{\verified}[1]{\begin{center}\fbox{{\bf\small Verified: #1}}\end{center}}
\fi

\renewcommand\AA{\ensuremath{\mathbb A}\xspace}
\newcommand\BB{\ensuremath{\mathbb B}\xspace}
\newcommand\CC{\ensuremath{\mathbb C}\xspace}
\newcommand\DD{\ensuremath{\mathbb D}\xspace}
\newcommand\EE{\ensuremath{\mathbb E}\xspace}
\newcommand\FF{\ensuremath{\mathbb F}\xspace}
\newcommand\GG{\ensuremath{\mathbb G}\xspace}
\newcommand\HH{\ensuremath{\mathbb H}\xspace}
\newcommand\II{\ensuremath{\mathbb I}\xspace}
\newcommand\NN{\ensuremath{\mathbb N}\xspace}
\newcommand\PP{\ensuremath{\mathbb P}\xspace}
\newcommand\QQ{\ensuremath{\mathbb Q}\xspace}
\newcommand\RR{\ensuremath{\mathbb R}\xspace}
\newcommand\VV{\ensuremath{\mathbb V}\xspace}
\newcommand\XX{\ensuremath{\mathbb X}\xspace}
\newcommand\ZZ{\ensuremath{\mathbb Z}\xspace}

\newcommand\AAA{\ensuremath{\mathcal A}\xspace}
\newcommand\BBB{\ensuremath{\mathcal B}\xspace}
\newcommand\CCC{\ensuremath{\mathcal C}\xspace}
\newcommand\DDD{\ensuremath{\mathcal D}\xspace}
\newcommand\EEE{\ensuremath{\mathcal E}\xspace}
\newcommand\FFF{\ensuremath{\mathcal F}\xspace}
\newcommand\GGG{\ensuremath{\mathcal G}\xspace}
\newcommand\HHH{\ensuremath{\mathcal H}\xspace}
\newcommand\III{\ensuremath{\mathcal I}\xspace}
\newcommand\JJJ{\ensuremath{\mathcal J}\xspace}
\newcommand\KKK{\ensuremath{\mathcal K}\xspace}
\newcommand\LLL{\ensuremath{\mathcal L}\xspace}
\newcommand\MMM{\ensuremath{\mathcal M}\xspace}
\newcommand\NNN{\ensuremath{\mathcal N}\xspace}
\newcommand\OOO{\ensuremath{\mathcal O}\xspace}
\newcommand\PPP{\ensuremath{\mathcal P}\xspace}
\newcommand\QQQ{\ensuremath{\mathcal Q}\xspace}
\newcommand\RRR{\ensuremath{\mathcal R}\xspace}
\newcommand\SSS{\ensuremath{\mathcal S}\xspace}
\newcommand\TTT{\ensuremath{\mathcal T}\xspace}
\newcommand\UUU{\ensuremath{\mathcal U}\xspace}
\newcommand\VVV{\ensuremath{\mathcal V}\xspace}
\newcommand\WWW{\ensuremath{\mathcal W}\xspace}
\newcommand\XXX{\ensuremath{\mathcal X}\xspace}
\newcommand\YYY{\ensuremath{\mathcal Y}\xspace}
\newcommand\ZZZ{\ensuremath{\mathcal Z}\xspace}

%
% Generic macros
%

\newcommand{\bool}{{\ensuremath{\{0,1\}}}}
\newcommand{\oneton}{\ensuremath{\{1,\ldots,n\}}}
\newcommand{\oneto}[1]{\ensuremath{\{1,\ldots,#1\}}}
\newcommand{\zeroton}{\ensuremath{\{0,\ldots,n\}}}
\newcommand{\zeroto}[1]{\ensuremath{\{0,\ldots,#1\}}}

\renewcommand{\to}{\ensuremath{\rightarrow}}
\newcommand{\from}{\ensuremath{\leftarrow}}

\newcommand{\intersection}{\ensuremath{\cap}}
\newcommand{\union}{\ensuremath{\cup}}

\newcommand{\xor}{\ensuremath{\oplus}}
\newcommand{\Xor}{\ensuremath{\bigoplus}}

\newcommand{\bra}{\ensuremath{\langle}}
\newcommand{\ket}{\ensuremath{\rangle}}

\newcommand{\eps}{\ensuremath{\epsilon}}

\newcommand{\randin}{\ensuremath{\in_R}}
\newcommand{\eqdef}{\stackrel{\textrm{def}}{=}}

\newcommand{\angles}[1]{\ensuremath{\langle{#1}\rangle}}
\newcommand{\ceil}[1]{\ensuremath{\lceil{#1}\rceil}}
\newcommand{\floor}[1]{\ensuremath{\lfloor{#1}\rfloor}}
\newcommand{\pair}[2]{\ensuremath{\langle{#1,#2}\rangle}}

\newcommand{\abs}[1]{\ensuremath{\lvert{#1}\rvert}}
\newcommand{\Abs}[1]{\ensuremath{\left\lvert{#1}\right\rvert}}
\newcommand{\brac}[1]{\ensuremath{[#1]}}
\newcommand{\Brac}[1]{\ensuremath{\left[#1\right]}}
\newcommand{\norm}[1]{\ensuremath{\lVert{#1}\rVert}}
\newcommand{\Norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\paren}[1]{\ensuremath{(#1)}}
\newcommand{\Paren}[1]{\ensuremath{\left(#1\right)}}
\newcommand{\set}[1]{\ensuremath{\{#1\}}}
\newcommand{\Set}[1]{\ensuremath{\left\{#1\right\}}}
\newcommand{\inv}{^{-1}}

\newcommand{\poly}{\ensuremath{\text{poly}}}

\newcommand{\bigo}[1]{\ensuremath{\OOO\Paren{#1}}}
\newcommand{\ppt}{\ensuremath{\sc{ppt}}}

\newcommand{\Party}[1][\relax]{\ensuremath{P_{#1}}\xspace}
\newcommand{\PA}{\Party[1]}
\newcommand{\PB}{\Party[2]}
\newcommand{\PC}{\Party[3]}
\newcommand{\PAm}{\ensuremath{{P_1^*}}\xspace}
\newcommand{\PBm}{\ensuremath{{P_2^*}}\xspace}
\newcommand{\PCm}{\ensuremath{{P_3^*}}\xspace}

\newcommand{\Zp}{\ensuremath{\ZZ_p}}
\newcommand{\Zq}{\ensuremath{\ZZ_q}}

\newcommand{\Sim}[1][\relax]{\ensuremath{\SSS_{#1}}\xspace}
\newcommand{\Adv}[1][\relax]{\ensuremath{\mathcal{A}_{#1}}\xspace}

\newcommand{\Hybrid}[1][\relax]{\ensuremath{\mathbf{Hybrid_{#1}}}\xspace}
\newcommand{\Real}{\ensuremath{\mathbf{Real}}\xspace}
\newcommand{\Ideal}{\ensuremath{\mathbf{Ideal}}\xspace}

\newcommand{\ind}{\ensuremath{\approx}}
\newcommand{\cind}{\stackrel{\textrm{c}}{\ind}}
\newcommand{\dind}{\stackrel{\textrm{d}}{\ind}}

%
% Reference macros
%

\ifreflinks%
\newcommand{\sref}[2]{\hyperref[#2]{#1~\ref*{#2}}}
\else
\newcommand{\sref}[2]{#1~\ref{#2}}
\fi

\newcommand{\refalg}[1]{\sref{Algorithm}{#1}}
\newcommand{\refapx}[1]{\sref{Appendix}{#1}}
\newcommand{\refconst}[1]{\sref{Construction}{#1}}
\newcommand{\refdef}[1]{\sref{Definition}{#1}}
\ifreflinks%
  \newcommand{\refeqn}[1]{\ref{#1}}
  % \newcommand{\refeqn}[1]{\hyperref[#1]{(\ref*{#1})}}
\else
  \newcommand{\refeqn}[1]{\ref{#1}}
\fi
\newcommand{\reffact}[1]{\sref{Fact}{#1}}
\newcommand{\reffig}[1]{\sref{Figure}{#1}}
\newcommand{\reflemma}[1]{\sref{Lemma}{#1}}
\newcommand{\refcor}[1]{\sref{Corollary}{#1}}
\newcommand{\refprop}[1]{\sref{Property}{#1}}
\newcommand{\refprot}[1]{\sref{Protocol}{#1}}
\newcommand{\refsec}[1]{\sref{Section}{#1}}
\newcommand{\refstep}[1]{\sref{Step}{#1}}
\newcommand{\reftab}[1]{\sref{Table}{#1}}
\newcommand{\refthm}[1]{\sref{Theorem}{#1}}

%% \newcommand{\refsteps}[2][\relax]{%
%%   \def\tempa{}%
%%   \@for\reserved:=#2\do{%
%%     \edef\tempa{\tempa\ifx\tempa\empty\else~#1 \fi\ref{\reserved}}%
%%   }%
%%   Steps~\tempa%
%% }

%
% Theorem macros
%

\newtheorem{claim}{Claim}
\newtheorem{lemma}{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{protocol}{Protocol}


%
% Bellare, Hoang, Rogaway notation macros
%

\newcommand{\Gb}{\ensuremath{\mathsf{Garble}}}
\newcommand{\En}{\ensuremath{\mathsf{Encrypt}}}
\newcommand{\De}{\ensuremath{\mathsf{Decrypt}}}
\newcommand{\ev}{\ensuremath{\mathsf{eval}}}
\newcommand{\Ev}{\ensuremath{\mathsf{Eval}}}

\newcommand{\GS}{\ensuremath{\mathsf{GS}}}

\newcommand{\proc}{\ensuremath{\mathbf{procedure}}}
\newcommand{\PrvInd}{{\rm PrvInd}}
\newcommand{\PrvSim}{{\rm PrvSim}}

\newcommand{\Enc}{\ensuremath{\mathsf{Enc}}\xspace}
\newcommand{\Gen}{\ensuremath{\mathsf{Gen}}\xspace}
\newcommand{\Dec}{\ensuremath{\mathsf{Dec}}\xspace}

\newcommand{\com}{\ensuremath{\mathsf{com}}\xspace}

%
% Canetti00 formalisms
%

\newcommand{\Coutput}{\ensuremath{\mathsf{output}}\xspace}
\newcommand{\Cview}{\ensuremath{\mathsf{view}}\xspace}

\newcommand{\len}{\ensuremath{\ell}\xspace}
\newcommand{\secparam}{\ensuremath{k}\xspace}
\newcommand{\ssecparam}{\ensuremath{s}\xspace}

\newcommand{\secpar}{\secparam}
\newcommand{\ssecpar}{\ssecparam}

\newcommand{\mask}{\ensuremath{\lambda}\xspace}
\newcommand{\boolsec}{\ensuremath{\bool^\secparam}\xspace}

%
% Environments
%

\newlength{\saveparindent}
\setlength{\saveparindent}{\parindent}
\newlength{\saveparskip}
\setlength{\saveparskip}{\parskip}

\newcounter{ctr}
\newcounter{savectr}
\newcounter{ectr}

\newenvironment{tiret}{%
  \begin{list}
    {\hspace{1pt}\rule[0.5ex]{6pt}{1pt}\hfill}
    {\labelwidth=15pt%
      \labelsep=3pt%
      \leftmargin=18pt%
      \topsep=1pt%
      \setlength{\listparindent}{\saveparindent}%
      \setlength{\parsep}{\saveparskip}%
      \setlength{\itemsep}{1pt}}
}{%
  \end{list}
}

% \newenvironment{newenum}{%
%   \begin{list}
%     {{\rm\arabic{ctr}.}\hfill}
%     {\usecounter{ctr}
%       \labelwidth=17pt%
%       \labelsep=6pt%
%       \leftmargin=23pt%
%       \topsep=.5pt%
%       \setlength{\listparindent}{\saveparindent}%
%       \setlength{\parsep}{\saveparskip}%
%       \setlength{\itemsep}{5pt}}
% }{%
%   \end{list}
% }

% \newenvironment{neweenum}{%
%   \begin{list}
%     {{\rm\arabic{ctr}.\arabic{ectr}}\hfill}
%     {\usecounter{ectr}%
%       \labelwidth=28pt%
%       \labelsep=4pt%
%       \leftmargin=34pt%
%       \topsep=0pt%
%       \setlength{\listparindent}{\saveparindent}%
%       \setlength{\parsep}{\saveparskip}%
%       \setlength{\itemsep}{2pt}}
% }{%
%   \end{list}
% }

% \newenvironment{parenum}{%
%   \begin{list}
%     {{\rm(\arabic{ctr})}\hfill}
%     {\usecounter{ctr}%
%       \labelwidth=17pt%
%       \labelsep=6pt%
%       \leftmargin=23pt%
%       \topsep=.5pt%
%       \setlength{\listparindent}{\saveparindent}%
%       \setlength{\parsep}{\saveparskip}%
%       \setlength{\itemsep}{5pt}}
% }{%
%   \end{list}
% }

% \newenvironment{venum}{%
%   \begin{list}
%     {{\rm\arabic{ctr}.}\hfill}
%     {\usecounter{ctr}%
%       \labelwidth=17pt%
%       \labelsep=6pt%
%       \leftmargin=23pt%
%       \topsep=.5pt%
%       %% \setlength{\listparindent}{\saveparindent}%
%       \setlength{\parsep}{\saveparskip}%
%       \setlength{\itemsep}{1pt}}
% }{%
%   \end{list}
% }

\newenvironment{nfbox}[1]{
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
          #1
}{%
      \end{minipage}
    \end{framed}
  \end{center}
}

\newenvironment{nfprot}[2]{
  \footnotesize
  \begin{framed}
    \vspace{-3ex}
    {\begin{center}{\bf Protocol} #1 \end{center}}
    #2
  }{
    \smallskip
  \end{framed}
}

\newenvironment{nfprotfig}[2]{
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
        {\begin{center}{\bf Protocol} #1 \end{center}}
        #2
}{
        \smallskip
      \end{minipage}
    \end{framed}
  \end{center}
}


\newenvironment{nffunc}[2]{
  \begin{center}
    \footnotesize
    \begin{framed}
      \begin{minipage}{.95\linewidth}
        \underline{{\bf Functionality} #1}
        \medskip
        #2
}{%
      \end{minipage}
    \end{framed}
  \end{center}
}

% \newenvironment{citemize}{
%   \begin{itemize}
%     \setlength{\itemsep}{1pt}
%     \setlength{\parskip}{0pt}
%     \setlength{\parsep}{0pt}
% }{
%   \end{itemize}
% }

% \newenvironment{cenumerate}{
%   \begin{enumerate}
%     \setlength{\itemsep}{1pt}
%     \setlength{\parskip}{0pt}
%     \setlength{\parsep}{0pt}
% }{
%   \end{enumerate}
% }

%
% other
%

\newcommand{\cancel}[1]{}

% functionalities
\newcommand{\func}[1][\relax]{\ensuremath{\mathcal{F}_\mathbf{#1}}\xspace}

% protocols
\newcommand{\Prot}[1][\relax]{\ensuremath{\Pi_\mathbf{#1}}\xspace}

\newcommand{\randfrom}{\ensuremath{\stackrel{\$}{\from}}}

\newcommand{\nins}{\ensuremath{\mathsf{n}}}
\newcommand{\ngates}{\ensuremath{\mathsf{q}}}
\newcommand{\nouts}{\ensuremath{\mathsf{m}}}
\newcommand{\lfn}{\ensuremath{L}}
\newcommand{\rfn}{\ensuremath{R}}
\newcommand{\gfn}{\ensuremath{G}}
\newcommand{\pfn}{\ensuremath{P}}

\newcommand{\Fail}[1]{\ensuremath{\mathsf{Fail}_{#1}}}

%
% bibtex stuff
%

\newcommand{\FullVersion}[1]{Full version available at \url{#1}}

\endinput
